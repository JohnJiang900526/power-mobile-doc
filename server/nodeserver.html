<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nodeServer 配置信息 | 普华移动端配置文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="PowerMobile2配置文档">
    
    <link rel="preload" href="/power-mobile-doc/assets/css/0.styles.f3b9fda0.css" as="style"><link rel="preload" href="/power-mobile-doc/assets/js/app.8d5ac0e3.js" as="script"><link rel="preload" href="/power-mobile-doc/assets/js/2.1ea3a5b3.js" as="script"><link rel="preload" href="/power-mobile-doc/assets/js/36.8d96e9f9.js" as="script"><link rel="prefetch" href="/power-mobile-doc/assets/js/10.70a478ee.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/11.f5fa1c8b.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/12.69f8d4a9.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/13.91ec78d2.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/14.19fbf184.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/15.17bd0f1f.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/16.8d470b47.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/17.79ae7a54.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/18.d66f7caf.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/19.2856945f.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/20.59817170.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/21.0bd602b6.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/22.99cebbc9.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/23.2232176f.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/24.2ed991cd.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/25.9aa7f882.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/26.cbb2ff66.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/27.05f4ca3e.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/28.38acff3e.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/29.7c22e78b.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/3.1e4fe1d5.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/30.154eba3f.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/31.4d3f771f.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/32.30c503ef.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/33.56319324.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/34.d2003f5d.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/35.bf09e34b.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/37.a113b3c1.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/38.aa37c813.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/39.dfae094b.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/4.e7c996f5.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/40.797af377.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/41.8d396d1b.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/42.bd70f9aa.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/43.40ebb227.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/44.228c5b75.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/45.04d281f3.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/5.6eff8140.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/6.17d5dd20.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/7.de41a641.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/8.cae3b3a5.js"><link rel="prefetch" href="/power-mobile-doc/assets/js/9.0c31e364.js">
    <link rel="stylesheet" href="/power-mobile-doc/assets/css/0.styles.f3b9fda0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/power-mobile-doc/" class="home-link router-link-active"><!----> <span class="site-name">普华移动端配置文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/power-mobile-doc/resource/learning.html" class="nav-link">
  学习中心
</a></div><div class="nav-item"><a href="/power-mobile-doc/conf/window.html" class="nav-link">
  窗体表单配置
</a></div><div class="nav-item"><a href="/power-mobile-doc/api/" class="nav-link">
  API文档
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="接口文档" class="dropdown-title"><span class="title">接口文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="接口文档" class="mobile-dropdown-title"><span class="title">接口文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/power-mobile-doc/mobile-interface/" class="nav-link">
  移动端接口文档
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/power-mobile-doc/resource/doc.html" class="nav-link">
  文档下载
</a></li><li class="dropdown-item"><!----> <a href="/power-mobile-doc/resource/email.html" class="nav-link">
  意见反馈
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/power-mobile-doc/resource/learning.html" class="nav-link">
  学习中心
</a></div><div class="nav-item"><a href="/power-mobile-doc/conf/window.html" class="nav-link">
  窗体表单配置
</a></div><div class="nav-item"><a href="/power-mobile-doc/api/" class="nav-link">
  API文档
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="接口文档" class="dropdown-title"><span class="title">接口文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="接口文档" class="mobile-dropdown-title"><span class="title">接口文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/power-mobile-doc/mobile-interface/" class="nav-link">
  移动端接口文档
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/power-mobile-doc/resource/doc.html" class="nav-link">
  文档下载
</a></li><li class="dropdown-item"><!----> <a href="/power-mobile-doc/resource/email.html" class="nav-link">
  意见反馈
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>初识 PowerMobile2</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/start/" class="sidebar-link">介绍</a></li><li><a href="/power-mobile-doc/start/install.html" class="sidebar-link">安装 Power-Mobile APP</a></li><li><a href="/power-mobile-doc/start/version.html" class="sidebar-link">PowerMobile2 版本更新</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>APP服务端部署</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/server/" aria-current="page" class="sidebar-link">PowerMobile2 服务端配置文档</a></li><li><a href="/power-mobile-doc/server/config.html" class="sidebar-link">配置config.js</a></li><li><a href="/power-mobile-doc/server/configedit.html" class="sidebar-link">Power.ConfigEdit.exe APP配置信息</a></li><li><a href="/power-mobile-doc/server/nodeserver.html" aria-current="page" class="active sidebar-link">nodeServer 配置信息</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#获取nodeserver文件夹" class="sidebar-link">获取nodeServer文件夹</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#安装node" class="sidebar-link">安装node</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#测试npm是否自动安装" class="sidebar-link">测试npm是否自动安装</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#安装cnpm" class="sidebar-link">安装cnpm</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#安装pm2" class="sidebar-link">安装pm2</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#配置nodeserver文件夹中的-env信息" class="sidebar-link">配置nodeServer文件夹中的.env信息</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#安装nodeserver的依赖包" class="sidebar-link">安装nodeServer的依赖包</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#测试nodeserver是否正常运行" class="sidebar-link">测试nodeServer是否正常运行</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#使用pm2管理nodeserver" class="sidebar-link">使用pm2管理nodeServer</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#nodeserver自动重启" class="sidebar-link">nodeServer自动重启</a></li><li class="sidebar-sub-header"><a href="/power-mobile-doc/server/nodeserver.html#查看执行项目的状态" class="sidebar-link">查看执行项目的状态</a></li></ul></li><li><a href="/power-mobile-doc/server/oracle.html" class="sidebar-link">Oracle 数据库环境变量配置</a></li><li><a href="/power-mobile-doc/server/https.html" class="sidebar-link">nodeServer https配置</a></li><li><a href="/power-mobile-doc/server/apppush.html" class="sidebar-link">APP推送消息的配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Web配置文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/web/" class="sidebar-link">PowerMobile2 Web配置文档</a></li><li><a href="/power-mobile-doc/web/devplat.html" class="sidebar-link">开发平台使用简要说明</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>配置文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/conf/window.html" class="sidebar-link">窗体的详细配置</a></li><li><a href="/power-mobile-doc/conf/form.html" class="sidebar-link">表单的详细配置</a></li><li><a href="/power-mobile-doc/conf/guide.html" class="sidebar-link">向导的详细配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>企业微信配置</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/wechat/" class="sidebar-link">企业微信配置</a></li><li><a href="/power-mobile-doc/wechat/wechatpush.html" class="sidebar-link">微信消息推送</a></li><li><a href="/power-mobile-doc/wechat/outmenu.html" class="sidebar-link">输出PowerMobile2菜单</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/api/" class="sidebar-link">API文档说明</a></li><li><a href="/power-mobile-doc/api/system.html" class="sidebar-link">系统方法 API</a></li><li><a href="/power-mobile-doc/api/single.html" class="sidebar-link">单点登录 页面说明</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>移动端接口</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/mobile-interface/" class="sidebar-link">接口说明</a></li><li><a href="/power-mobile-doc/mobile-interface/public.html" class="sidebar-link">公用接口</a></li><li><a href="/power-mobile-doc/mobile-interface/message.html" class="sidebar-link">消息</a></li><li><a href="/power-mobile-doc/mobile-interface/form.html" class="sidebar-link">表单接口</a></li><li><a href="/power-mobile-doc/mobile-interface/dynamic.html" class="sidebar-link">动态</a></li><li><a href="/power-mobile-doc/mobile-interface/my.html" class="sidebar-link">个人中心</a></li><li><a href="/power-mobile-doc/mobile-interface/other.html" class="sidebar-link">系统通用其他接口</a></li><li><a href="/power-mobile-doc/mobile-interface/work.html" class="sidebar-link">工作台</a></li><li><a href="/power-mobile-doc/mobile-interface/wechat.html" class="sidebar-link">企业微信接口</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>资源中心</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/power-mobile-doc/resource/learning.html" class="sidebar-link">PowerMobile2 学习中心</a></li><li><a href="/power-mobile-doc/resource/doc.html" class="sidebar-link">下载说明</a></li><li><a href="/power-mobile-doc/resource/email.html" class="sidebar-link">意见反馈</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nodeserver-配置信息"><a href="#nodeserver-配置信息" class="header-anchor">#</a> nodeServer 配置信息</h1> <h2 id="获取nodeserver文件夹"><a href="#获取nodeserver文件夹" class="header-anchor">#</a> 获取nodeServer文件夹</h2> <p>获取nodeServer文件夹,
把nodeServer放在服务器上适当的位置，尽可能不要和项目文件放在一起。
比如项目的目录是D:\www\7109-PowerPMS_PMIS，那么nodeServer文件夹可
以放在D盘的根目录下，比如：D:\nodeServer</p> <h2 id="安装node"><a href="#安装node" class="header-anchor">#</a> 安装node</h2> <p>在<a href="http://nodejs.cn/" target="_blank" rel="noopener noreferrer">node官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，下载最新的node版本，安装在服务器上，
在windows系统下，一般下载的是node-v12.10.0-x64.msi文件，在服务器上点
击这个文件，按照向导进行正常操作即可。
安装完node之后，可以在cmd命令行中执行node -v的命令，如果正常安装，会打印出对应的版本号。
如下图：</p> <img src="/power-mobile-doc/img/图片4.png"> <h2 id="测试npm是否自动安装"><a href="#测试npm是否自动安装" class="header-anchor">#</a> 测试npm是否自动安装</h2> <p>安装完成node之后，一般npm会自动安装，检测npm是否自动安装的方法 可以在cmd中执行npm -v。如下图：</p> <img src="/power-mobile-doc/img/图片5.png"> <h2 id="安装cnpm"><a href="#安装cnpm" class="header-anchor">#</a> 安装cnpm</h2> <p>cnpm和npm有同样的功能，主要是安装node服务的依赖文件，npm是国外做的，
cnpm是国内做的，npm安装依赖的时候有可能会出现下载依赖报错的情况，如果
出现报错，删除nodeServer文件夹下面的node_modules的文件夹。</p> <p>安装cnpm的方法：在cmd中执行npm install cnpm -g,如下图：</p> <img src="/power-mobile-doc/img/图片6.png"> <h2 id="安装pm2"><a href="#安装pm2" class="header-anchor">#</a> 安装pm2</h2> <p>pm2主要是用来管理node服务的,类似iis一样的存在，npm install pm2 -g
或者
cnpm install pm2 -g</p> <h2 id="配置nodeserver文件夹中的-env信息"><a href="#配置nodeserver文件夹中的-env信息" class="header-anchor">#</a> 配置nodeServer文件夹中的.env信息</h2> <p>进入nodeServer文件夹，打开.env文件，如下所示：</p> <div class="language-js extra-class"><pre class="language-js"><code># <span class="token punctuation">.</span>env示例文件
# 当前环境 <span class="token operator">:</span> dev（开发） <span class="token function">pro</span> <span class="token punctuation">(</span>生产<span class="token punctuation">)</span>
cur_env <span class="token operator">=</span> dev

# <span class="token constant">SOCKET</span>通讯服务器地址、端口
<span class="token constant">SOCKET_PORT</span> <span class="token operator">=</span> <span class="token number">3000</span>

# redis通讯服务器地址及端口
<span class="token constant">REDIS_HOST</span> <span class="token operator">=</span> xxx<span class="token punctuation">.</span>com
<span class="token constant">REDIS_PORT</span> <span class="token operator">=</span> <span class="token number">6379</span>
<span class="token constant">REDIS_PWD</span> <span class="token operator">=</span>

# 站点码
<span class="token constant">HOST_CODE</span> <span class="token operator">=</span> mis
<span class="token constant">HOST_SITE</span> <span class="token operator">=</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xxx.com:7109</span><span class="token regex-delimiter">/</span></span>

# 数据库类型 sql_server<span class="token punctuation">,</span><span class="token function">oracle</span><span class="token punctuation">(</span>不设置默认sql_server<span class="token punctuation">)</span>
<span class="token constant">DB_TYPE</span> <span class="token operator">=</span>

# 数据库连接信息，无论配置是否存在正确与否， <span class="token function">后面都会从redis重新取一次。账号，密码，服务器地址</span><span class="token punctuation">(</span>oracle有可能是<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">/</span>orcl<span class="token punctuation">)</span>，端口，数据库
<span class="token constant">DB_ID</span> <span class="token operator">=</span> test
<span class="token constant">DB_PWD</span> <span class="token operator">=</span> test@<span class="token number">2008</span>
<span class="token constant">DB_HOST</span> <span class="token operator">=</span> xxx<span class="token punctuation">.</span>com
<span class="token constant">DB_PORT</span> <span class="token operator">=</span><span class="token number">7100</span>
<span class="token constant">DB_DATABASE</span> <span class="token operator">=</span> PowerPMDB_PMIS

# 极光推送配置
<span class="token constant">T_KEY</span> <span class="token operator">=</span> f1b07a32465bd1741978f8e6
<span class="token constant">T_SECRET</span> <span class="token operator">=</span> da057374ad2ca2af815599ee

# MongoDB 这里的配置可以忽略
<span class="token constant">MONGO_DB</span> <span class="token operator">=</span> app_msg
# <span class="token constant">MONGO_URL</span> <span class="token operator">=</span> mongodb<span class="token operator">+</span>srv<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>admin<span class="token operator">:</span>admin_123@cluster0<span class="token operator">-</span><span class="token number">35</span>wrv<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>net<span class="token operator">/</span>app_msg<span class="token operator">?</span>retryWrites<span class="token operator">=</span><span class="token boolean">true</span>
# 本机不加密数据库
<span class="token constant">MONGO_URL</span> <span class="token operator">=</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>app_msg<span class="token operator">?</span>retryWrites<span class="token operator">=</span><span class="token boolean">true</span>
</code></pre></div><h4 id="_1-socket通讯服务器地址、端口"><a href="#_1-socket通讯服务器地址、端口" class="header-anchor">#</a> 1. SOCKET通讯服务器地址、端口</h4> <p>配置 SOCKET通讯服务器地址、端口，比如是3000，保证此端口号没有被占用，否则设置失败。</p> <h4 id="_2-redis通讯服务器地址及端口"><a href="#_2-redis通讯服务器地址及端口" class="header-anchor">#</a> 2. redis通讯服务器地址及端口</h4> <p>1).配置REDIS_HOST，配置项目所需要的redis的host,比如：xxx.com</p> <p>2).配置REDIS_PORT，配置redis的端口号，比如7109</p> <p>3).配置REDIS_PWD的密码，如果为空则不用配置</p> <h4 id="_3-配置站点码"><a href="#_3-配置站点码" class="header-anchor">#</a> 3. 配置站点码</h4> <p>1).配置站点码HOST_CODE，比如mis,必须保证站点码的唯一性</p> <p>2).配置站点地址HOST_SITE，比如：http://xxx:7109/，
HOST_SITE代表的是项目的站点地址，在1).中的站点码就是
HOST_SITE的站点码，站点码设置的地方在下图所示位置：</p> <img src="/power-mobile-doc/img/图片7.png"> <h4 id="_4-数据库类型-db-type"><a href="#_4-数据库类型-db-type" class="header-anchor">#</a> 4.数据库类型 DB_TYPE</h4> <p>如果数据库是sql_server,  DB_TYPE = sql_server</p> <p>如果数据库是oracle，DB_TYPE = oracle</p> <p>如果不配置默认是sql_server</p> <p>如果数据库是oracle，请参考 <a href="/power-mobile-doc/server/oracle.html">oracle环境配置</a></p> <h4 id="_5-数据库连接信息-无论配置是否存在正确与否-后面都会从redis重新取一次。账号-密码-服务器地址-端口-数据库"><a href="#_5-数据库连接信息-无论配置是否存在正确与否-后面都会从redis重新取一次。账号-密码-服务器地址-端口-数据库" class="header-anchor">#</a> 5. 数据库连接信息，无论配置是否存在正确与否， 后面都会从redis重新取一次。账号，密码，服务器地址，端口，数据库</h4> <p>1).数据库账号DB_ID，比如john</p> <p>2).数据库密码DB_PWD,比如john123456</p> <p>3).服务器地址DB_HOST,比如dev.p3china.com</p> <p>4).数据库端口DB_PORT，比如：7112</p> <p>5).数据库名称DB_DATABASE</p> <h2 id="安装nodeserver的依赖包"><a href="#安装nodeserver的依赖包" class="header-anchor">#</a> 安装nodeServer的依赖包</h2> <p>比如nodeServer文件夹的目录为D:/nodeServer，cmd打开对应的路径，执行cnpm install,
依赖安装需要一定的时间，耐心等待所有的依赖安装完成。如下图：</p> <img src="/power-mobile-doc/img/图片8.png"> <h2 id="测试nodeserver是否正常运行"><a href="#测试nodeserver是否正常运行" class="header-anchor">#</a> 测试nodeServer是否正常运行</h2> <p>点击nodeServer文件夹下面的启动服务.bat文件，临时启动项目，如果bat文件启动无误，则nodeServer可以正常运行。</p> <h2 id="使用pm2管理nodeserver"><a href="#使用pm2管理nodeserver" class="header-anchor">#</a> 使用pm2管理nodeServer</h2> <p>使用cmd进入nodeServer的目录，执行pm2 start index.js,如下图：</p> <img src="/power-mobile-doc/img/图片9.png"> <h2 id="nodeserver自动重启"><a href="#nodeserver自动重启" class="header-anchor">#</a> nodeServer自动重启</h2> <p>为了保证nodeServer在服务器重启之后能自动重启，可以执行一下命令命令，如下图</p> <p><strong>第1步：安装pm2:</strong><br>
如果已经安装，此处省略。</p> <p><strong>第2步：安装并配置pm2-windows-service:</strong><br></p> <div class="language-js extra-class"><pre class="language-js"><code>npm i <span class="token operator">-</span>g pm2<span class="token operator">-</span>windows<span class="token operator">-</span>service
</code></pre></div><p>或者</p> <div class="language-js extra-class"><pre class="language-js"><code>cnpm i <span class="token operator">-</span>g pm2<span class="token operator">-</span>windows<span class="token operator">-</span>service
</code></pre></div><p>如果cnpm报错，请先执行：</p> <div class="language-js extra-class"><pre class="language-js"><code>npm i cnpm <span class="token operator">-</span>g

cnpm i <span class="token operator">-</span>g pm2<span class="token operator">-</span>windows<span class="token operator">-</span>service
</code></pre></div><p><strong>第3步：添加.pm2的系统环境变量:</strong><br>
一般默认的.pm2路径是：C:\Users\Administrator.pm2，如果自己修改了，注意此路径的变化
<img src="/power-mobile-doc/img/20210406101633.png"></p> <p><strong>第4步：以管理员权限打开新的cmd命令行窗口,执行以下命令来安装服务:</strong><br></p> <div class="language-js extra-class"><pre class="language-js"><code>pm2<span class="token operator">-</span>service<span class="token operator">-</span>install
</code></pre></div><p>执行 pm2-service-install 命令的时候 按照自己的需要进行回答，如果不清楚，写Y</p> <p><strong>第5步：启动nodeServer服务:</strong><br></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 进入nodeServer文件夹</span>
cd nodeServer

<span class="token comment">// 如果已经执行了，可以跳过此步骤</span>
pm2 start index<span class="token punctuation">.</span>js
</code></pre></div><p><strong>第6步：启动pm2保存:</strong><br></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 前提是 已经执行了pm2 start index.js</span>
pm2 save
</code></pre></div><img src="/power-mobile-doc/img/图片10.png"> <p>在服务中可以查看PM2的运行状态</p> <img src="/power-mobile-doc/img/20210406102855.png"> <h2 id="查看执行项目的状态"><a href="#查看执行项目的状态" class="header-anchor">#</a> 查看执行项目的状态</h2> <p>保证nodeServer能正常运行，可以通过pm2 list查看执行项目的状态，
如果nodeServer出现意外挂掉了，可以手动重启，
具体的命令行参考<a href="https://www.jianshu.com/p/9cab8f7020c1" target="_blank" rel="noopener noreferrer">pm2的命令行列表<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/power-mobile-doc/server/configedit.html" class="prev">
        Power.ConfigEdit.exe APP配置信息
      </a></span> <span class="next"><a href="/power-mobile-doc/server/oracle.html">
        Oracle 数据库环境变量配置
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/power-mobile-doc/assets/js/app.8d5ac0e3.js" defer></script><script src="/power-mobile-doc/assets/js/2.1ea3a5b3.js" defer></script><script src="/power-mobile-doc/assets/js/36.8d96e9f9.js" defer></script>
  </body>
</html>
